(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{39:function(e,t){},41:function(e,t){},51:function(e,t,c){},52:function(e,t,c){"use strict";c.r(t);var a=c(1),n=c.n(a),l=c(19),s=c.n(l),r=c(20),i=c(21),o=c(10),j=c.n(o),d=c(0);const b=Object(a.createContext)(),m=Object(i.a)("viber-rest-api-production.up.railway.app"),u=e=>{let{children:t}=e;const[c,n]=Object(a.useState)(!1),[l,s]=Object(a.useState)(!1),[r,i]=Object(a.useState)(),[o,u]=Object(a.useState)(""),[O,h]=Object(a.useState)({}),[x,v]=Object(a.useState)(""),p=Object(a.useRef)(),g=Object(a.useRef)(),C=Object(a.useRef)();Object(a.useEffect)((()=>{(async()=>{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});i(e),p.current.srcObject=e})(),m.on("me",(e=>v(e))),console.log(x),m.on("callUser",(e=>{let{from:t,name:c,signal:a}=e;h({isReceivingCall:!0,from:t,name:c,signal:a})}))}),[x]);return Object(d.jsx)(b.Provider,{value:{call:O,callAccepted:c,myVideo:p,userVideo:g,stream:r,name:o,setName:u,callEnded:l,me:x,callUser:e=>{const t=new j.a({initiator:!0,trickle:!1,stream:r});t.on("signal",(t=>{m.emit("callUser",{userToCall:e,signalData:t,from:x,name:o})})),t.on("stream",(e=>{g.current.srcObject=e})),m.on("callAccepted",(e=>{n(!0),t.signal(e)})),C.current=t},leaveCall:()=>{s(!0),C.current.destroy(),window.location.reload()},answerCall:()=>{n(!0);const e=new j.a({initiator:!1,trickle:!1,stream:r});e.on("signal",(e=>{m.emit("answerCall",{signal:e,to:O.from})})),e.on("stream",(e=>{g.current.srcObject=e})),e.signal(O.signal),C.current=e}},children:t})};var O=e=>{let{children:t,ham:c}=e;const{me:n,callAccepted:l,name:s,setName:i,callEnded:o,leaveCall:j,callUser:m}=Object(a.useContext)(b),[u,O]=Object(a.useState)("");return Object(d.jsx)("div",{className:"controlbar ".concat(c?"openham":""),children:Object(d.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(d.jsxs)("div",{className:"column",children:[Object(d.jsx)("p",{children:"My Information"}),Object(d.jsx)("input",{type:"text",placeholder:"Name",value:s,onChange:e=>i(e.target.value)}),Object(d.jsx)(r.CopyToClipboard,{text:n,children:Object(d.jsx)("button",{onClick:e=>e.preventDefault(),children:"Generate & Copy ID"})})]}),Object(d.jsxs)("div",{className:"column",children:[Object(d.jsx)("p",{children:"Make a call"}),Object(d.jsx)("input",{type:"text",placeholder:"ID to call",value:u,onChange:e=>O(e.target.value)}),l&&!o?Object(d.jsx)("button",{onClick:e=>{e.preventDefault(),j()},className:"hangup",children:"Hang Up"}):Object(d.jsx)("button",{onClick:e=>{e.preventDefault(),""===s||"Name"===s?alert("Enter name before calling."):m(u)},className:"call",children:"Call"})]}),t]})})};var h=e=>{let{ham:t,setHam:c}=e;return Object(d.jsxs)("div",{className:"navbar",children:[Object(d.jsxs)("div",{className:"hamburger",onClick:()=>{c(!t)},children:[Object(d.jsx)("div",{className:"line"}),Object(d.jsx)("div",{className:"line"}),Object(d.jsx)("div",{className:"line"})]}),Object(d.jsx)("h3",{children:"Viber - Video Chat App"})]})};var x=()=>{const{answerCall:e,call:t,callAccepted:c}=Object(a.useContext)(b);return Object(d.jsx)(d.Fragment,{children:t.isReceivingCall&&!c&&Object(d.jsxs)("div",{className:"notif",children:[Object(d.jsxs)("p",{children:[t.name," is calling:"]}),Object(d.jsx)("button",{onClick:t=>{t.preventDefault(),e()},children:"Answer"})]})})};var v=()=>{const{name:e,callAccepted:t,myVideo:c,userVideo:n,callEnded:l,stream:s,call:r}=Object(a.useContext)(b);return Object(d.jsxs)("div",{className:"videoContainer",children:[s&&Object(d.jsxs)("div",{className:"video",children:[Object(d.jsx)("h3",{children:e||"Name"}),Object(d.jsx)("video",{playsInline:!0,muted:!0,ref:c,autoPlay:!0})]}),t&&!l&&Object(d.jsxs)("div",{className:"video",children:[Object(d.jsx)("h3",{children:r.name||"Name"}),Object(d.jsx)("video",{playsInline:!0,ref:n,autoPlay:!0})]})]})};var p=()=>{const[e,t]=Object(a.useState)(!1);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(h,{ham:e,setHam:t}),Object(d.jsx)(v,{}),Object(d.jsx)(O,{ham:e,children:Object(d.jsx)(x,{})})]})};c(51);s.a.render(Object(d.jsx)(n.a.StrictMode,{children:Object(d.jsx)(u,{children:Object(d.jsx)(p,{})})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.4205d10c.chunk.js.map